{%- assign item = section.settings -%}

{%- comment -%}
  Cálculo de tamaño “sizes” en desktop según el grid elegido (col-img)
{%- endcomment -%}
{%- assign col = item.grid | split: '.' | first | plus: 0 -%}
{%- case col -%}
  {%- when 3 -%}{% assign desktop_size = '25vw' %}
  {%- when 4 -%}{% assign desktop_size = '33vw' %}
  {%- when 5 -%}{% assign desktop_size = '42vw' %}
  {%- when 6 -%}{% assign desktop_size = '50vw' %}
  {%- when 7 -%}{% assign desktop_size = '58vw' %}
  {%- when 8 -%}{% assign desktop_size = '67vw' %}
  {%- when 9 -%}{% assign desktop_size = '75vw' %}
  {%- when 10 -%}{% assign desktop_size = '83vw' %}
  {%- else -%}{% assign desktop_size = '50vw' %}
{%- endcase -%}

<div class="{{ section.settings.customCSS }} {% if item.top_offset == 'none' %}nomargin {% elsif item.top_offset == 'small' %}tt-offset-small {% endif %}container-indent tpisection{{ section.id }}">
  {% if item.usebgcolor %}
    <div class="layout-box01-wrapper"
         {% if item.showbgimage_bg and item.image_bg %}
           style="background-image: url({{ item.image_bg | image_url: width: 1920, format: 'webp' }});"
         {% endif %}>
  {% endif %}

    <div class="container{% if item.fullwidth %}-fluid{% endif %}">
      <!-- obj -->
      <div class="row tt-layout-box01{% if item.reverse %} flex-row-reverse{% endif %} {{ item.contentalign }}">
        <div class="col-img col-md-{{ item.grid | split: '.' | first }}{% unless item.showimage %} d-sm-none-custom{% endunless %} respimgsize">
          {% if item.showimage %}
            {% if item.image == blank %}
              {%- include "get_svg" type:'image' size:'580x400' -%}
            {% else %}

              {%- comment -%} PRELOAD solo en Home (mejora LCP) {%- endcomment -%}
              {% if template == 'index' %}
                <link rel="preload" as="image"
                      href="{{ item.image | image_url: width: 1280, format: 'webp' }}"
                      imagesrcset="
                        {{ item.image | image_url: width: 480,  format: 'webp' }} 480w,
                        {{ item.image | image_url: width: 768,  format: 'webp' }} 768w,
                        {{ item.image | image_url: width: 1024, format: 'webp' }} 1024w,
                        {{ item.image | image_url: width: 1280, format: 'webp' }} 1280w,
                        {{ item.image | image_url: width: 1600, format: 'webp' }} 1600w"
                      imagesizes="(max-width: 1024px) 92vw, {{ desktop_size }}"
                      fetchpriority="high">
              {% endif %}

              {%- assign base_w = 1280 -%}
              {%- assign base_h = base_w | divided_by: item.image.aspect_ratio | round -%}

              <img
                src="{{ item.image | image_url: width: 1024, format: 'webp' }}"
                srcset="
                  {{ item.image | image_url: width: 480,  format: 'webp' }} 480w,
                  {{ item.image | image_url: width: 768,  format: 'webp' }} 768w,
                  {{ item.image | image_url: width: 1024, format: 'webp' }} 1024w,
                  {{ item.image | image_url: width: 1280, format: 'webp' }} 1280w,
                  {{ item.image | image_url: width: 1600, format: 'webp' }} 1600w"
                sizes="(max-width: 1024px) 92vw, {{ desktop_size }}"
                width="{{ base_w }}" height="{{ base_h }}"
                alt="{{ item.image.alt | escape }}"
                decoding="async"
                fetchpriority="high" />

            {% endif %}
          {% endif %}
        </div>

        <div class="col-description col-md-{{ item.grid | split: '.' | last }} text-{{ item.textalign }}">
          {%- if item.text1 != "" -%}<h6 class="tt-title">{{ item.text1 }}</h6>{%- endif -%}
          {%- if item.text2 != "" -%}<p>{{ item.text2 }}</p>{%- endif -%}
          {%- if item.showbtn -%}
            {%- if item.showbtn_aslink -%}
              <a href="{{ item.btnurl }}"
                 class="hover-underline{% if item.underlinebydefault %} underlinebydefault{% endif %} btn-section-css">{{ item.btntext }}</a>
            {%- else -%}
              <a href="{{ item.btnurl }}"
                 class="btn btn-section-css"
                 style="background:{{ item.bg_color }}; color:{{ item.cbtntext }};"
                 data-bgc="{{ item.bg_color }}" data-abgc="{{ item.bg_color_a }}"
                 data-c="{{ item.cbtntext }}" data-ac="{{ item.cbtntext_a }}" data-hovercolors>
                 {{ item.btntext }}
              </a>
            {%- endif -%}
          {%- endif -%}
        </div>
      </div>
      <!-- /obj -->
    </div>

  {% if item.usebgcolor %}</div>{% endif %}
</div>

<style>
  .tpisection{{ section.id }} .tt-layout-box01 .col-description{
    font-weight: {{ item.fontweighttext2 }};
    color: {{ item.colortext2 }};
  }
  .tpisection{{ section.id }} .tt-layout-box01 .col-description .tt-title{
    font-weight: {{ item.fontweighttext1 }};
    color: {{ item.colortext1 }};
  }
  @media (min-width: 1025px){
    .tpisection{{ section.id }} .tt-layout-box01 .col-description{
      font-size: {{ item.fontsizetext2 }}px;
      line-height: {{ item.lineheighttext2 }}px;
    }
    .tpisection{{ section.id }} .tt-layout-box01 .col-description .tt-title{
      font-size: {{ item.fontsizetext1 }}px;
      line-height: {{ item.lineheighttext1 }}px;
      padding: 0 0 {{ item.bottompaddingtext1 }}px 0;
    }
  }
  @media (max-width: 1024px){
    .tpisection{{ section.id }} .tt-layout-box01 .col-description{
      font-size: {{ item.fontsizetext2_mobile }}px;
      line-height: {{ item.lineheighttext2_mobile }}px;
    }
    .tpisection{{ section.id }} .tt-layout-box01 .col-description .tt-title{
      font-size: {{ item.fontsizetext1_mobile }}px;
      line-height: {{ item.lineheighttext1_mobile }}px;
      padding-bottom: {{ item.bottompaddingtext1_mobile }}px;
    }
  }
  .tpisection{{ section.id }} .layout-box01-wrapper{
    background-color: {{ item.bgco }};
    background-repeat: no-repeat;
    background-size: {{ item.imagesize_bg }};
    background-position: {{ item.imagealign_bg }};
  }
  .tpisection{{ section.id }} .tt-layout-box01:not(.flex-row-reverse) .col-description{
    padding-left: {{ item.textoffset }}px;
  }
  .tpisection{{ section.id }} .tt-layout-box01.flex-row-reverse .col-description:last-child{
    padding-right: {{ item.textoffset }}px;
  }

  {% if item.btn_custom_styles != '' %}
  .tpisection{{ section.id }} .tt-layout-box01 .col-description .btn{
    {{ item.btn_custom_styles }}
  }
  {% endif %}
  {% if item.btn_custom_styles_hover != '' %}
  .tpisection{{ section.id }} .tt-layout-box01 .col-description .btn:hover{
    {{ item.btn_custom_styles_hover }}
  }
  {% endif %}

  @media (min-width: 1025px){
    .tpisection{{ section.id }} .tt-layout-box01 .col-description .btn-section-css{
      margin-top: {{ item.buttonpadding }}px;
    }
    .tpisection{{ section.id }} .layout-box01-wrapper{
      padding-top: {{ item.bgdepad }}px;
      padding-bottom: {{ item.bgdepad_2 }}px;
    }
  }
  @media (max-width: 1024px){
    .tpisection{{ section.id }} .tt-layout-box01 .col-description .btn-section-css{
      margin-top: {{ item.buttonpadding_mobile }}px;
    }
    .tpisection{{ section.id }} .layout-box01-wrapper{
      padding-top: {{ item.bgmopad }}px;
      padding-bottom: {{ item.bgmopad_2 }}px;
    }
  }

  {% if item.usemiheight %}
  @media (min-width: 791px){
    .tpisection{{ section.id }} > div > div > .row{
      min-height: {{ item.backgroundminheight2 }}px;
    }
  }
  @media (min-width: 1200px){
    .tpisection{{ section.id }} > div > div > .row{
      min-height: {{ item.backgroundminheight3 }}px;
    }
  }
  @media (max-width: 790px){
    .tpisection{{ section.id }} > div > div > .row{
      min-height: {{ item.backgroundminheight1 }}px;
    }
  }
  {% endif %}

  .tpisection{{ section.id }} .tt-layout-box01 a.hover-underline{
    font-size: {{ item.linkbtnsizetext }}px;
    line-height: {{ item.linkbtnsizetext }}px;
    font-weight: {{ item.linkbtnweighttext }};
    color: {{ item.cbtntext }};
    -webkit-transition: color .2s ease-out;
    transition: color .2s ease-out;
  }
  .tpisection{{ section.id }} .tt-layout-box01 a.hover-underline:before{
    background: {{ item.bg_color_a }};
    bottom: -1px;
  }
  .tpisection{{ section.id }} .tt-layout-box01 a.hover-underline.underlinebydefault:before{
    width: 100%;
    background: {{ item.bg_color }};
    -webkit-transition: all .3s ease-out;
    transition: all .3s ease-out;
  }
  .tpisection{{ section.id }} .tt-layout-box01 a.hover-underline:hover{
    color: {{ item.cbtntext_a }};
  }
  .tpisection{{ section.id }} .tt-layout-box01 a.hover-underline.underlinebydefault:hover:before{
    width: 0%;
    background: {{ item.bg_color_a }};
  }
</style>
